## 分库分表
**分表**

数据量过大，会影响SQL执行效率，一般单表到几百万就要进行分表

**分库**

当并发量过高，需要将一个库数据拆分到多个库中

### 垂直分表(建议)
按列进行拆分，通常情况，某个表中的字段比较多，可以新建立一张“扩展表”，将不经常使用或者长度较大的字段拆分出去放到“扩展表”中，如下：

拆分前：

|   a   |   b   |   c   |   d   |
| :---: | :---: | :---: | :---: |
|       |       |       |       |

拆分后：

|   a   |   b   |
| :---: | :---: |
|       |       |

|   c   |   d   |
| :---: | :---: |
|       |       |

### 水平分表(不建议)
将表中不同的数据行按照一定规律分布到不同的数据库表中（这些表保存在同一个数据库中）。最常见的方式就是通过主键或者时间等字段进行 Hash 和取模后拆分
### 垂直分库
按照业务模块来划分出不同的数据库，在高并发场景下，垂直分库一定程度上能够突破 IO、连接数及单机硬件资源的瓶颈，是大型分布式系统中优化数据库架构的重要手段。
### 水平分库
原理同水平分表







## 主从复制
主从复制（Replication）是指数据可以从一个MySQL数据库主服务器复制到一个或多个从服务器，从服务器可以复制主服务器中的所有数据库或者特定的数据库，或者特定的表。默认采用异步模式。

**实现原理**：
1. 主服务器 binary log dump 线程将主服务器将数据更改日志写入bin log
2. 从服务器 I/O 线程从服务器从主服务器读取bin log，写入本地Relay log
3. 从服务器 SQL 线程读取 Relay log，在从服务器中执行。

**优点**：
1. 读写分离：主服务器负责写，从服务器负责读
    * 缓解了锁的争用，即使主服务器中加了锁，依然可以进行读操作；
    * 从服务器可以使用 MyISAM，提升查询性能以及节约系统开销；
    * 增加冗余，提高可用性
2. 数据实时备份，当系统中某个节点发生故障时，可以方便的故障切换
3. 降低单个服务器磁盘I/O访问的频率，提高单个机器的I/O性能

**缺点**：
1. 数据不一致问题
2. 提升操作和运维的复杂性
## 数据库优化

